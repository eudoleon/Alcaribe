<?xml version='1.0' encoding='utf-8'?>
<odoo>
  <record id="dual_purchase_oder_form_inherit" model="ir.ui.view">
        <field name="name">dual.purchase.order.form.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form"/>
        <field name="arch" type="xml">
            
     
            <xpath expr="//sheet" position="before">
                <div class="alert alert-success mb-0 text-center" role="alert">
                    <field name="validate_Check_orderline" invisible="1"/>
                    <div class="oe_center">
                        <h2>
                        <i class="fa fa-money fa-sm"/>  Tasa del DÃ­a : <field name="tax_day"  force_save="1"  attrs="{'readonly': [('state', 'not in', ('draft', 'done'))]}"/>
                        <!-- attrs="{'readonly':[('validate_Check_orderline','=',False)]}" -->
                        </h2>
                        <p>La tasa no podra ser modificada despues de agregar lineas de productos y solo se editara en estado Borrador <strong>Presupuestos.</strong></p>
                        <button name="updateRateDate" 
                                type="object" 
                                icon="fa-refresh" 
                                string="Actualizar" 
                                class="btn btn-secondary mt-1"
                                attrs="{'invisible': [('state', 'not in', ('draft', 'done'))]}"
                        /> 
                    </div>
                    
                    
                </div>
            
            </xpath>



            <xpath expr="//group[@class='oe_subtotal_footer oe_right']" position="replace">
                    <field name="currency_ref_id" invisible="1"/>
                    <group class="oe_subtotal_footer oe_right" colspan="2" name="purchase_total">
                        <div class="ml-4 p-1">
                            <table class="" style="margin-right:40px;">
                                    <tbody>
                                        <tr>
                                            <td class="o_td_label">
                                            <div class="o_field_widget o_readonly_modifier o_field_monetary">
                                                    <span>Base Imponible Bs. :</span>
                                                </div>
                                            </td>
                                            <td class="o_td_label">
                                                <span style="white-space: nowrap; font-weight: bold;">
                                                    <field name="amount_untaxed_bs" options="{'currency_field': 'currency_ref_id', 'field_digits': True}"/>
                                                </span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="o_td_label">
                                                <div class="o_field_widget o_readonly_modifier o_field_monetary">
                                                    <span>Impuesto Bs. :</span>
                                                </div>
                                            </td>
                                            <td class="o_td_label">
                                                <field name="amount_tax_bs" options="{'currency_field': 'currency_ref_id', 'field_digits': True}"/>
                                            </td>

                                        </tr>
                                        <tr>
                                            <td class="o_td_label">
                                                <div class="o_field_widget o_readonly_modifier o_field_monetary">
                                                    <span>Total Bs. :</span>
                                                </div>
                                            </td>
                                            <td class="o_td_label">
                                                <span style="'font-size: 1.3em; font-weight: bold; white-space: nowrap;'" class="oe_subtotal_footer_separator">
                                                    <field name="amount_total_bs" options="{'currency_field': 'currency_ref_id', 'field_digits': True}"/>
                                                </span>
                                                
                                            </td>
                                        </tr>

                                    </tbody>
                                </table>
                        
                        </div>
                        <div class="ml-4 p-1">
                      
                                <field name="tax_totals" widget="account-tax-totals-field" nolabel="1" colspan="2" readonly="1"/>
                    
                        </div>

                    </group>
                </xpath>
                
                <xpath expr="//field[@name = 'order_line']//tree/field[@name = 'display_type']" position="before">
                    <field name="currency_ref_id" invisible = "1" />
                </xpath>
                
                <xpath expr="//field[@name = 'order_line']//tree/field[@name = 'price_unit']" position="before">
                    <field name="price_unit_bs" attrs="{'readonly': [('qty_invoiced', '&gt;', 0)]}" options="{'currency_field': 'order_id.currency_ref_id', 'field_digits': True}"/>
                </xpath>

                <xpath expr="//field[@name = 'order_line']//tree/field[@name = 'price_subtotal']" position="before">
                     <field name="subtoal_amount_bs"  options="{'currency_field': 'order_id.currency_ref_id', 'field_digits': True}"/>
                </xpath>



        </field>
  </record>

  
  <record id="purchase_order_dual_view_tree" model="ir.ui.view">
    <field name="name">purchase.order.dual.view.tree</field>
    <field name="model">purchase.order</field>
    <field name="inherit_id" ref="purchase.purchase_order_kpis_tree"/>
    <field name="arch" type="xml">
        <xpath expr="//field[@name='amount_total']" position="after">
            <field name="tax_day" optional="show"/>
                <field name="amount_total_bs" optional="show"/>  
        </xpath>

    </field>
  </record>


  


</odoo>